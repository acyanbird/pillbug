import{G as O,W as U,S as V,P as q,C as N,a as J,V as K,T as Q,R as v,b as X,M as b,D as Y,c as m,A as Z,d as B,m as _,B as k,e as I,g as $,l as ee,f as te,h as ne,i as ie,j as oe,k as re}from"./getpoint-C1CRuDEX.js";const ae=""+new URL("gm-CvwIPEh9.jpg",import.meta.url).href;let w,se=new O,a,T=.16,p={},l,A,d,n,s,C,P,h=3,g=0,y=!1,i,G=[],o,W=[],x=window.innerWidth,L=window.innerHeight,M=window.innerWidth/window.innerHeight,z="Life: ",E="Score: ",F="Game Over",R="Final Score: ";function de(){new URLSearchParams(window.location.search).get("lang")==="zh"&&(z="生命: ",E="分数: ",F="游戏结束",R="最终得分: ",document.getElementById("score").innerHTML=E+0,document.getElementById("life").innerHTML=z+3,document.getElementById("endText").innerHTML=F,document.getElementById("restart").innerHTML="点击这里回到主菜单",document.getElementById("restart").href="index-zh.html"),C=document.getElementById("gl-canvas"),s=new U({canvas:C,antialias:!0}),l=H(3),A=H(5),d=l,n=new V,s.setSize(x,L),s.shadowMap.enabled=!0,s.shadowMap.type=q,s.setClearColor(new N("skyblue")),ue(),fe(),ge(),S("red",-50,2),S("cyan",-20,1),S("yellow",-10,.5),pe(),ce(),s.render(n,d),window.addEventListener("click",function(){le()}),j(),window.addEventListener("resize",we),window.addEventListener("keydown",function(t){p[t.key]=!0}),window.addEventListener("keyup",function(t){p[t.key]=!1})}de();function le(){d===l?d=A:d=l,s.render(n,d)}function H(e){let t=new J(75,M,.1,1e3);return t.position.y=e,t.lookAt(new K(0,0,-10)),t}function ce(){let e=new Q().load(ae);e.wrapS=v,e.wrapT=v,e.repeat.set(1,12);let t=new X(10,120,1,12),c=new b({map:e,side:Y}),u=new m(t,c);u.position.set(0,0,-60),u.rotation.x=Math.PI/2,u.receiveShadow=!0,n.add(u)}function ue(){P=new Z(16777215,.8),n.add(P);const e=new B(16777215,.8);e.position.set(0,3,20),e.castShadow=!0,n.add(e);const t=new B("orange",1);t.position.set(0,20,-20),t.castShadow=!0,n.add(t)}function we(){x=window.innerWidth,L=window.innerHeight,M=window.innerWidth/window.innerHeight,l.aspect=M,l.updateProjectionMatrix(),s.setSize(x,L),s.render(n,l)}function pe(){se.load(_,function(e){a=e.scene,a.scale.set(.3,.3,.3),a.position.set(0,0,-3),e.scene.traverse(function(t){t.isMesh&&(t.castShadow=!0)}),n.add(a),w=new k().setFromObject(a)},void 0,function(e){console.error(e)})}function j(){y||(a&&w.setFromObject(a),W.forEach(e=>{e.position.z+=T,e.visible=e.position.z<0&&e.position.z>-100,e.position.z>0&&(e.position.x=r(-4,4),e.position.z+=r(-110,-60)),e.rotation.x+=.01,e.rotation.y+=.01;let t=new I(e.position,.18);w&&w.intersectsSphere(t)&&(e.position.x=r(-4,4),e.position.z+=r(-110,-60),g+=1,document.getElementById("score").innerHTML=E+g,new Audio($).play())}),G.forEach(e=>{e.position.z+=T,e.visible=e.position.z<0&&e.position.z>-100,e.position.z>0&&(e.position.x=r(-4,4),e.position.z+=r(-140,-60)),e.rotation.x+=.01,e.rotation.y+=.01;let t=new I(e.position,.35);w&&w.intersectsSphere(t)&&(e.position.x=r(-4,4),e.position.z+=r(-140,-60),h-=1,document.getElementById("life").innerHTML=z+h,h!==0?new Audio(ee).play():(new Audio(te).play(),y=!0,document.getElementById("finalScore").innerHTML=R+g,document.getElementById("end").style.display="block"))}),p.ArrowLeft&&a.position.x>-3.5&&(a.position.x-=.05),p.ArrowRight&&a.position.x<3.5&&(a.position.x+=.05),s.render(n,d),y||requestAnimationFrame(j))}function r(e,t){return Math.random()*(t-e)+e}function me(){let e=new ie(.4),t=new b({color:16761035,transparent:!0,opacity:.9});return i=new m(e,t),i.castShadow=!0,i.receiveShadow=!0,i.rotation.x=Math.PI/4,i.rotation.y=Math.PI/4,n.add(i),i}function fe(){for(let e=0;e<5;e+=1)i=me(),i.position.set(r(-4,4),.5,r(-140,-60)),G.push(i),n.add(i),i.boundingBox=new k().setFromObject(i)}function he(){let e=new oe(.2,32,32),t=new re({color:16766720,metalness:.8,roughness:.5});return o=new m(e,t),o.castShadow=!0,o.receiveShadow=!0,n.add(o),o.geometry.computeBoundingSphere(),o.boundingSphere=o.geometry.boundingSphere,o}function ge(){for(let e=0;e<15;e+=1)o=he(),o.position.set(r(-4,4),.2,r(-140,-60)),W.push(o),n.add(o)}function S(e,t,c){let u=new ne(7,c,16,100),D=new b({color:e}),f=new m(u,D);f.castShadow=!0,f.position.set(0,0,t),n.add(f)}
